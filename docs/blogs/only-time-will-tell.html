<!DOCTYPE html>
<html lang="en">

<head>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
    <link rel="icon" href="../favicon.ico" type="image/x-icon">

    <title>commonware > Binding Timelock Encryption: Only Time Will Tell</title>
    <meta name="description" content="As your parents insisted when you were growing up, good things come to those who wait. It turns out recent advances in cryptography have proven them right.">
    <meta name="author" content="Patrick O'Grady">
    <meta name="keywords" content="commonware, timelock encryption, BTLE, battleware, cryptography, blockchain, temporal privacy, VRF, threshold signatures">

    <meta property="og:url" content="https://commonware.xyz/blogs/only-time-will-tell.html" />
    <meta property="og:type" content="article" />
    <meta property="og:site_name" content="commonware" />
    <meta property="og:image" content="https://commonware.xyz/imgs/timelock-decryption.png" />
    <meta property="og:title" content="Binding Timelock Encryption: Only Time Will Tell" />
    <meta property="og:description" content="As your parents insisted when you were growing up, good things come to those who wait. It turns out recent advances in cryptography have proven them right." />
    <meta property="article:author" content="https://x.com/_patrickogrady" />
    <meta property="article:published_time" content="2025-09-11T00:00:00Z" />
    <meta property="article:modified_time" content="2025-09-11T00:00:00Z" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta property="twitter:domain" content="commonware.xyz" />
    <meta property="twitter:url" content="https://commonware.xyz/blogs/only-time-will-tell.html" />
    <meta property="twitter:title" content="Binding Timelock Encryption: Only Time Will Tell" />
    <meta property="twitter:description" content="As your parents insisted when you were growing up, good things come to those who wait. It turns out recent advances in cryptography have proven them right." />
    <meta property="twitter:image" content="https://commonware.xyz/imgs/timelock-decryption.png" />
    <meta property="twitter:site" content="@commonwarexyz" />
    <meta property="twitter:creator" content="@_patrickogrady" />

    <link rel="stylesheet" type="text/css" href="../style.css">
</head>

<body>
    <div id="logo-placeholder">
        <div class="logo-line">
            <span class="edge-logo-symbol">+</span>
            <span class="horizontal-logo-symbol">~</span>
            <span class="horizontal-logo-symbol"> </span>
            <span class="horizontal-logo-symbol">-</span>
            <span class="horizontal-logo-symbol">+</span>
            <span class="horizontal-logo-symbol">-</span>
            <span class="horizontal-logo-symbol">+</span>
            <span class="horizontal-logo-symbol"> </span>
            <span class="horizontal-logo-symbol">-</span>
            <span class="horizontal-logo-symbol">+</span>
            <span class="horizontal-logo-symbol">-</span>
            <span class="horizontal-logo-symbol">~</span>
            <span class="horizontal-logo-symbol">~</span>
            <span class="edge-logo-symbol">*</span>
        </div>
        <div class="logo-line">
            <span class="vertical-logo-symbol">|</span>
            <span class="logo-text"> commonware </span>
            <span class="vertical-logo-symbol"> </span>
        </div>
        <div class="logo-line">
            <span class="edge-logo-symbol">*</span>
            <span class="horizontal-logo-symbol">~</span>
            <span class="horizontal-logo-symbol">+</span>
            <span class="horizontal-logo-symbol">+</span>
            <span class="horizontal-logo-symbol">-</span>
            <span class="horizontal-logo-symbol"> </span>
            <span class="horizontal-logo-symbol">~</span>
            <span class="horizontal-logo-symbol">-</span>
            <span class="horizontal-logo-symbol">+</span>
            <span class="horizontal-logo-symbol"> </span>
            <span class="horizontal-logo-symbol">-</span>
            <span class="horizontal-logo-symbol">*</span>
            <span class="horizontal-logo-symbol">-</span>
            <span class="edge-logo-symbol">+</span>
        </div>
    </div>
    <div class="content">
        <h1>Binding Timelock Encryption: Only Time Will Tell</h1>
        <div class="meta">
            <div class="author">By <a href="https://x.com/_patrickogrady">Patrick O'Grady</a></div>
            <div class="date">September 11, 2025</div>
        </div>
        <p>As your parents insisted when you were growing up, good things come to those who wait. It turns out recent advances in cryptography have proven them right.</p>
        <p>When competing head-to-head, revealing your move before your opponent gives them an obvious advantage. If I know you're playing rock, I'll play paper. Whether it's rock-paper-scissors or a keyword auction for search results, competitive applications need to hide submissions until everyone has committed. That's why they typically run on centralized infrastructure where moves can be blinded until resolution.</p>
        <p>Blockchains don't yet offer this "temporal privacy". Transactions are public the moment they hit the mempool. Look no further than the meteoric rise of MEV bots that monitor mempools, frontrun trades, and sandwich transactions to see the value of this information leakage.</p>
        <p>What if blockchains could run fair competitions?</p>
        <h2>The Missing Primitive: Binding Timelock Encryption (BTLE)</h2>
        <p>Enter <a href="https://eprint.iacr.org/2023/189">Practical Timelock Encryption (TLE)</a>. TLE lets you encrypt data that cannot be decrypted until a future moment (specifically, when validators generate a threshold signature over a known message). Once that signature exists, anyone can use it as a decryption key to reveal the encrypted data. Simply put, if you know the static public key of some threshold set and you know a message it will sign at some point, you can encrypt data that can be decrypted when a signature is generated over that message.</p>
        <p>It turns out we already have such a signature generation mechanism in the <a href="https://github.com/commonwarexyz/monorepo">Commonware Library</a>: <a href="https://docs.rs/commonware-consensus/latest/commonware_consensus/threshold_simplex/index.html">threshold-simplex</a>'s Verifiable Random Function (VRF). At each view (every ~200ms on a global network), validators produce a threshold signature over the view number (a message that can be known ahead of time by anyone looking for a timelock encryption target).</p>
        <p>TLE, a standalone cryptographic primitive, however, lacks the ability to enforce commitments to encrypted data. Nothing in the TLE scheme prevents a user from sharing different encrypted data to different people or encrypting updated data if they change their mind. Embedded into a blockchain, TLE commitments become "Binding Timelock Encryption" (BTLE). Submit an encrypted move before the end of a contest, and you can't back out or change your mind (your move is stored in state and can't be changed). Anyone possessing the VRF output associated with the end of the contest can decrypt the committed ciphertext.</p>
        <p>With BTLE, blockchains can finally offer temporal privacy. Good things (or fair contests onchain), as your parents said, come to those who wait (for timelock decryption).</p>
        <h2>BATTLEWARE: Proving BTLE is Practical</h2>
        <p>To demonstrate how to use Binding Timelock Encryption, we built <a href="https://battleware.xyz">BATTLEWARE</a>. BATTLEWARE is an onchain game where players duel each other to climb a global leaderboard (sorted by ELO score). If you've played Pok√©mon, you'll feel right at home.</p>
        <div class="image-container">
            <img src="../imgs/battleware-duel.png" alt="A battle between two trainers on BATTLEWARE">
            <div class="image-caption">Figure 1: A battle between two trainers on BATTLEWARE. The opponent (DEVOTE RITUAL) has locked their move for this round but we can't see it yet.</div>
        </div>
        <p>It all starts when you submit a transaction to generate your "creature". The same signature generation mechanism used to power BTLE decryption doubles as the VRF used to randomly generate your creature's appearance, name, and moves.</p>
        <div class="image-container">
            <img src="../imgs/creature-generation.png" alt="Creature generation process">
            <div class="image-caption">Figure 2: A creature's traits are derived from the hash of your address, nonce, and a seed by the embedded VRF. The output of a VRF is only known after a block has been notarized (or nullified), so a player can't compute the outcome of the generation prior to their transaction's inclusion in a canonical block (under healthy network conditions).</div>
        </div>
        <p>With a creature generated, you can enter the arena for matchmaking. Again using the same VRF, we randomly pair you with some other player (making it a bit more difficult to play yourself to boost your ELO).</p>
        <div class="image-container">
            <img src="../imgs/matchmaking.png" alt="Matchmaking process">
            <div class="image-caption">Figure 3: Players submit match requests onchain and after a configurable amount of time has passed or the arena is full, players are paired and battles started.</div>
        </div>
        <p>Once in a battle, you have 15 rounds to defeat your opponent. During each round, both players submit moves encrypted to the view at which the current round will resolve (50 views after matching or the end of the previous round). Once that view is reached, either player can submit the VRF output to decrypt both players' moves and resolve the round. If a player has won, the battle resolves and each player's ELO score is updated. If not, the battle continues to the next round.</p>
        <div class="image-container">
            <img src="../imgs/timelock-decryption.png" alt="Move submission and settlement">
            <div class="image-caption">Figure 4: Any player can submit a settle transaction with the VRF output from the end of the round.</div>
        </div>
        <p>To make decryption performant enough for BATTLEWARE, we perform parallel decryption of moves during execution using a BATTLEWARE-specific execution environment.</p>
        <p>The entire implementation is <a href="https://github.com/commonwarexyz/battleware">open source</a> under both an MIT and Apache-2 license. The code is still a bit rough around the edges, but we were able to reach 77% test coverage (on ~11.2k lines of code). Consider it your opportunity to become a contributor.</p>
        <h2>Securing Player Access</h2>
        <p>Instead of trusting our API to provide access to game state, we opted to build a pipeline to provide visitors with authenticated access (like we did with <a href="https://alto.commonware.xyz">alto</a>). The big difference here being that BATTLEWARE players need to verify state and events against consensus outputs (rather than just consensus outputs directly).</p>
        <p>To accomplish this, we inject state changes and execution events into our <a href="https://docs.rs/commonware-storage/latest/commonware_storage/adb/index.html">ADBs</a>. We then use <a href="https://docs.rs/commonware-consensus/latest/commonware_consensus/aggregation/index.html">consensus::aggregation</a> to generate a threshold signature over the computed roots of each ADB. Because execution relies on the output of a VRF not available during verification, we cannot just use the threshold signature emitted by threshold-simplex (unfortunately).</p>
        <div class="image-container">
            <img src="../imgs/threshold-roots.png" alt="MMR state management">
            <div class="image-caption">Figure 5: After execution, the State ADB and Events ADB is updated and once wrapped by a threshold signature are pushed to Exoware.</div>
        </div>
        <p>Once a threshold signature is generated, validators then push these computed artifacts to <a href="https://exoware.xyz/">Exoware</a>. On-the-fly, Exoware generates Multi-Proofs over the events that each websocket subscriber is interested in to save bandwidth (the events for your account or the battle you're in).</p>
        <div class="image-container">
            <img src="../imgs/multi-proof.png" alt="Multi-proof generation">
            <div class="image-caption">Figure 6: Instead of sending a full proof and all events for each block, Exoware dynamically generates Multi-Proofs over only the events that matter to the subscriber.</div>
        </div>
        <p>These updates are processed by your browser where you both verify the threshold signature attesting to some set of roots was valid and that there exists a valid proof of your events in the provided root.</p>
        <h2>Wrapping Things Up</h2>
        <p>At Commonware, <a href="https://commonware.xyz/blogs/introducing-commonware.html">we believe that the best onchain experiences will develop a sustained edge through specialization</a>. Whether it a game, a trading application, a social network, or something only you know how to build, building a blockchain around a product provides differentiated capability that can't be bolted on to existing blockchains.</p>
        <p>We will (finally) have capacity to onboard our next Commonware design partner on October 1st. If you want to collaborate on a blockchain application that doesn't feel like one, reach out now (our next slot opens in 2026).</p>
    </div>

    <div id="footer-placeholder"></div>
    <script src="../shared.js"></script>
    <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "07159b86f75b4af18e54dd0cda2fb4a7"}'></script>
</body>

</html>